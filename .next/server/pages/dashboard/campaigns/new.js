(()=>{var e={};e.id=774,e.ids=[774,888,660],e.modules={4356:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>g,default:()=>x,getServerSideProps:()=>p,getStaticPaths:()=>h,getStaticProps:()=>u,reportWebVitals:()=>j,routeModule:()=>w,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>f,unstable_getStaticProps:()=>b});var r=t(7093),i=t(5244),l=t(1323),n=t(5388),c=t.n(n),d=t(1940),m=t(5321),o=e([d]);d=(o.then?(await o)():o)[0];let x=(0,l.l)(m,"default"),u=(0,l.l)(m,"getStaticProps"),h=(0,l.l)(m,"getStaticPaths"),p=(0,l.l)(m,"getServerSideProps"),g=(0,l.l)(m,"config"),j=(0,l.l)(m,"reportWebVitals"),b=(0,l.l)(m,"unstable_getStaticProps"),f=(0,l.l)(m,"unstable_getStaticPaths"),y=(0,l.l)(m,"unstable_getStaticParams"),N=(0,l.l)(m,"unstable_getServerProps"),v=(0,l.l)(m,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/dashboard/campaigns/new",pathname:"/dashboard/campaigns/new",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:m});a()}catch(e){a(e)}})},3042:(e,s,t)=>{"use strict";t.d(s,{Z:()=>y});var a=t(997),r=t(6689),i=t(1649),l=t(1664),n=t.n(l),c=t(1163),d=t(5491),m=t(8936),o=t(802),x=t(6271),u=t(467),h=t(9832),p=t(7344),g=t(2656),j=t(9067),b=t(1203),f=t(1924);function y({children:e}){let{data:s}=(0,i.useSession)(),t=(0,c.useRouter)(),[l,y]=(0,r.useState)(!1),N=[{name:"Overview",href:"/dashboard",icon:d.Z},{name:"Contacts",href:"/dashboard/contacts",icon:m.Z},{name:"Campaigns",href:"/dashboard/campaigns",icon:o.Z},{name:"Templates",href:"/dashboard/templates",icon:x.Z},{name:"Analytics",href:"/dashboard/analytics",icon:u.Z},{name:"Settings",href:"/dashboard/settings",icon:h.Z}];return p.Z,g.Z,j.Z,(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:`${l?"block":"hidden"} fixed inset-0 flex z-40 lg:hidden`,children:[a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>y(!1)}),(0,a.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[a.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:a.jsx("button",{className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>y(!1),children:a.jsx(b.Z,{className:"h-6 w-6 text-white"})})}),(0,a.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 flex items-center px-4",children:[a.jsx(x.Z,{className:"h-8 w-8 text-primary-600"}),a.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"LocalMailer"})]}),a.jsx("nav",{className:"mt-5 px-2 space-y-1",children:N.map(e=>{let s=e.icon,r=t.pathname===e.href;return(0,a.jsxs)(n(),{href:e.href,className:`${r?"sidebar-link active":"sidebar-link"}`,children:[a.jsx(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]})]})]}),a.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0 border-r border-gray-200 bg-white",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center flex-shrink-0 px-4",children:[a.jsx(x.Z,{className:"h-8 w-8 text-primary-600"}),a.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"LocalMailer"})]}),a.jsx("nav",{className:"mt-5 flex-1 px-2 space-y-1",children:N.map(e=>{let s=e.icon,r=t.pathname===e.href;return(0,a.jsxs)(n(),{href:e.href,className:`${r?"sidebar-link active":"sidebar-link"}`,children:[a.jsx(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]}),a.jsx("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[a.jsx("div",{children:a.jsx("img",{className:"inline-block h-9 w-9 rounded-full",src:s?.user?.image||"/api/placeholder/36/36",alt:""})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700",children:s?.user?.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[s?.user?.plan||"Free"," Plan"]})]})]})})]})}),(0,a.jsxs)("div",{className:"lg:pl-64 flex flex-col flex-1",children:[a.jsx("div",{className:"sticky top-0 z-10 lg:hidden pl-1 pt-1 sm:pl-3 sm:pt-3 bg-gray-50",children:a.jsx("button",{className:"-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-gray-500 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500",onClick:()=>y(!0),children:a.jsx(f.Z,{className:"h-6 w-6"})})}),a.jsx("main",{className:"flex-1",children:a.jsx("div",{className:"py-6",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e})})})]})]})}},243:(e,s,t)=>{"use strict";t.d(s,{L:()=>c});let a=require("next-auth/providers/google");var r=t.n(a);let i=require("@next-auth/prisma-adapter"),l=require("@prisma/client"),n=globalThis.prisma??new l.PrismaClient({log:["error"]}),c={adapter:(0,i.PrismaAdapter)(n),providers:[r()({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})],callbacks:{async session({session:e,user:s}){if(e?.user&&s){e.user.id=s.id;let t=await n.subscription.findUnique({where:{userId:s.id}});e.user.plan=t?.plan||"free",e.user.subscriptionStatus=t?.status||"inactive"}return e},async signIn({user:e,account:s,profile:t}){if(e.email&&s?.provider==="google")try{await n.emailSettings.upsert({where:{userId:e.id},create:{userId:e.id,fromName:e.name||"Your Business",fromEmail:e.email,replyTo:e.email},update:{}})}catch(e){console.error("Error creating email settings:",e)}return!0}},session:{strategy:"database"},pages:{signIn:"/auth/signin",error:"/auth/error"}}},1940:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>m});var r=t(997);t(6764);var i=t(1649),l=t(9752),n=t(6689),c=t(6201),d=e([l,c]);function m({Component:e,pageProps:{session:s,...t}}){let[a]=(0,n.useState)(()=>new l.QueryClient);return r.jsx(i.SessionProvider,{session:s,children:(0,r.jsxs)(l.QueryClientProvider,{client:a,children:[r.jsx(e,{...t}),r.jsx(c.Toaster,{position:"top-right"})]})})}[l,c]=d.then?(await d)():d,a()}catch(e){a(e)}})},5321:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b,getServerSideProps:()=>f});var a=t(997),r=t(3227),i=t(243),l=t(3042),n=t(6689);let c=(0,t(8387).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);var d=t(8936),m=t(1590),o=t(1321),x=t(705),u=t(802),h=t(1664),p=t.n(h),g=t(1163);function j(){let[e,s]=(0,n.useState)({name:"",subject:"",previewText:"",templateId:"",segmentId:"",content:"",scheduledAt:"",fromName:"",fromEmail:"",replyTo:""}),[t,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(""),[h,j]=(0,n.useState)(1),b=(0,g.useRouter)(),f=[{id:"launch",name:"Product Launch",description:"Announce your new product or course",category:"announcement",preview:"Clean layout with hero image and clear CTA"},{id:"newsletter",name:"Newsletter",description:"Regular updates for your audience",category:"newsletter",preview:"Simple text-focused design with sections"},{id:"update",name:"Product Update",description:"Share updates and improvements",category:"update",preview:"Feature highlights with visual elements"}],y=e=>{let{name:t,value:a}=e.target;s(e=>({...e,[t]:a}))},N=async s=>{r(!0),l("");try{let t={...e,status:"send"===s?"sending":"schedule"===s?"scheduled":"draft"},a=await fetch("/api/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok)b.push("/dashboard/campaigns");else{let e=await a.json();l(e.error||"Failed to create campaign")}}catch(e){l("Failed to create campaign. Please try again.")}finally{r(!1)}};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[a.jsx("div",{className:"mb-6",children:(0,a.jsxs)(p(),{href:"/dashboard/campaigns",className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[a.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Back to Campaigns"]})}),a.jsx("div",{className:"md:flex md:items-center md:justify-between mb-8",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Create New Campaign"}),a.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Design and send emails to your audience."})]})}),a.jsx("div",{className:"mb-8",children:a.jsx("nav",{className:"flex items-center justify-center","aria-label":"Progress",children:a.jsx("ol",{className:"flex items-center space-x-5",children:[{number:1,name:"Details"},{number:2,name:"Content"},{number:3,name:"Recipients"},{number:4,name:"Send"}].map((e,s)=>(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 ${h>=e.number?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-500"}`,children:e.number}),a.jsx("span",{className:`ml-2 text-sm font-medium ${h>=e.number?"text-blue-600":"text-gray-500"}`,children:e.name}),s<3&&a.jsx("div",{className:"ml-5 w-8 h-0.5 bg-gray-300"})]},e.name))})})}),a.jsx("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[i&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:a.jsx("p",{className:"text-sm text-red-800",children:i})}),(()=>{switch(h){case 1:return(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Campaign Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Campaign Name *"}),a.jsx("input",{type:"text",id:"name",name:"name",required:!0,className:"input-field mt-1",placeholder:"Q1 Product Update",value:e.name,onChange:y}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Internal name for this campaign"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"fromName",className:"block text-sm font-medium text-gray-700",children:"From Name"}),a.jsx("input",{type:"text",id:"fromName",name:"fromName",className:"input-field mt-1",placeholder:"Your Name",value:e.fromName,onChange:y})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700",children:"Email Subject *"}),a.jsx("input",{type:"text",id:"subject",name:"subject",required:!0,className:"input-field mt-1",placeholder:"\uD83D\uDE80 Exciting updates from [Your Project]",value:e.subject,onChange:y})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"previewText",className:"block text-sm font-medium text-gray-700",children:"Preview Text"}),a.jsx("input",{type:"text",id:"previewText",name:"previewText",className:"input-field mt-1",placeholder:"Quick preview text that appears in email clients...",value:e.previewText,onChange:y}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This text appears next to the subject line in email clients"})]})]});case 2:return(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Choose Template"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:f.map(t=>(0,a.jsxs)("div",{className:`border-2 rounded-lg p-4 cursor-pointer transition-colors ${e.templateId===t.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>s(e=>({...e,templateId:t.id})),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),a.jsx(c,{className:"h-5 w-5 text-gray-400"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:t.description}),a.jsx("p",{className:"text-xs text-gray-500",children:t.preview})]},t.id))}),e.templateId&&(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"Email Content"}),a.jsx("textarea",{id:"content",name:"content",rows:12,className:"input-field mt-1",placeholder:"Write your email content here...",value:e.content,onChange:y}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You can use Markdown formatting or HTML"})]})]});case 3:return(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Select Recipients"}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(d.Z,{className:"h-5 w-5 text-blue-600 mr-2"}),a.jsx("span",{className:"font-medium text-blue-900",children:"All Subscribers"})]}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Send to all active contacts (estimated: 1,234 recipients)"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"segmentId",className:"block text-sm font-medium text-gray-700",children:"Or choose a segment"}),(0,a.jsxs)("select",{id:"segmentId",name:"segmentId",className:"input-field mt-1",value:e.segmentId,onChange:y,children:[a.jsx("option",{value:"",children:"Send to all contacts"}),a.jsx("option",{value:"newsletter-subscribers",children:"Newsletter Subscribers (892)"}),a.jsx("option",{value:"course-customers",children:"Course Customers (156)"}),a.jsx("option",{value:"engaged-users",children:"Engaged Users (445)"})]})]})]});case 4:return(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Review & Send"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Campaign Details"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Name:"})," ",e.name]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Subject:"})," ",e.subject]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"From:"})," ",e.fromName||"Your Name"]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Template:"})," ",f.find(s=>s.id===e.templateId)?.name||"None"]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Recipients"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Segment:"})," ",e.segmentId||"All Contacts"]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Estimated reach:"})," 1,234 contacts"]})]})]})]})}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"scheduledAt",className:"block text-sm font-medium text-gray-700",children:"Schedule for later (optional)"}),a.jsx("input",{type:"datetime-local",id:"scheduledAt",name:"scheduledAt",className:"input-field mt-1",value:e.scheduledAt,onChange:y})]})]});default:return null}})(),(0,a.jsxs)("div",{className:"flex justify-between pt-6 border-t border-gray-200 mt-8",children:[a.jsx("button",{onClick:()=>j(Math.max(1,h-1)),disabled:1===h,className:"btn-outline disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),a.jsx("div",{className:"flex space-x-3",children:4===h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>N("draft"),disabled:t,className:"btn-outline",children:[a.jsx(o.Z,{className:"h-4 w-4 mr-2"}),"Save Draft"]}),e.scheduledAt?(0,a.jsxs)("button",{onClick:()=>N("schedule"),disabled:t,className:"btn-primary",children:[a.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"Schedule Campaign"]}):(0,a.jsxs)("button",{onClick:()=>N("send"),disabled:t,className:"btn-primary",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Send Now"]})]}):a.jsx("button",{onClick:()=>j(Math.min(4,h+1)),disabled:1===h&&(!e.name||!e.subject)||2===h&&!e.templateId,className:"btn-primary",children:"Continue"})})]})]})})]})}function b(){return a.jsx(l.Z,{children:a.jsx(j,{})})}let f=async e=>await (0,r.getServerSession)(e.req,e.res,i.L)?{props:{}}:{redirect:{destination:"/auth/signin",permanent:!1}}},6764:()=>{},3227:e=>{"use strict";e.exports=require("next-auth")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},9752:e=>{"use strict";e.exports=import("@tanstack/react-query")},6201:e=>{"use strict";e.exports=import("react-hot-toast")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")},1590:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},705:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},1321:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[388,571,119],()=>t(4356));module.exports=a})();