(()=>{var e={};e.id=479,e.ids=[479,888,660],e.modules={4045:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>f,default:()=>x,getServerSideProps:()=>p,getStaticPaths:()=>u,getStaticProps:()=>h,reportWebVitals:()=>g,routeModule:()=>w,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>j});var r=t(7093),l=t(5244),i=t(1323),n=t(5388),c=t.n(n),d=t(1940),o=t(9537),m=e([d]);d=(m.then?(await m)():m)[0];let x=(0,i.l)(o,"default"),h=(0,i.l)(o,"getStaticProps"),u=(0,i.l)(o,"getStaticPaths"),p=(0,i.l)(o,"getServerSideProps"),f=(0,i.l)(o,"config"),g=(0,i.l)(o,"reportWebVitals"),j=(0,i.l)(o,"unstable_getStaticProps"),y=(0,i.l)(o,"unstable_getStaticPaths"),v=(0,i.l)(o,"unstable_getStaticParams"),N=(0,i.l)(o,"unstable_getServerProps"),b=(0,i.l)(o,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/dashboard/contacts/import",pathname:"/dashboard/contacts/import",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:o});a()}catch(e){a(e)}})},3042:(e,s,t)=>{"use strict";t.d(s,{Z:()=>v});var a=t(997),r=t(6689),l=t(1649),i=t(1664),n=t.n(i),c=t(1163),d=t(5491),o=t(8936),m=t(802),x=t(6271),h=t(467),u=t(9832),p=t(7344),f=t(2656),g=t(9067),j=t(1203),y=t(1924);function v({children:e}){let{data:s}=(0,l.useSession)(),t=(0,c.useRouter)(),[i,v]=(0,r.useState)(!1),N=[{name:"Overview",href:"/dashboard",icon:d.Z},{name:"Contacts",href:"/dashboard/contacts",icon:o.Z},{name:"Campaigns",href:"/dashboard/campaigns",icon:m.Z},{name:"Templates",href:"/dashboard/templates",icon:x.Z},{name:"Analytics",href:"/dashboard/analytics",icon:h.Z},{name:"Settings",href:"/dashboard/settings",icon:u.Z}];return p.Z,f.Z,g.Z,(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:`${i?"block":"hidden"} fixed inset-0 flex z-40 lg:hidden`,children:[a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>v(!1)}),(0,a.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[a.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:a.jsx("button",{className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>v(!1),children:a.jsx(j.Z,{className:"h-6 w-6 text-white"})})}),(0,a.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 flex items-center px-4",children:[a.jsx(x.Z,{className:"h-8 w-8 text-primary-600"}),a.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"LocalMailer"})]}),a.jsx("nav",{className:"mt-5 px-2 space-y-1",children:N.map(e=>{let s=e.icon,r=t.pathname===e.href;return(0,a.jsxs)(n(),{href:e.href,className:`${r?"sidebar-link active":"sidebar-link"}`,children:[a.jsx(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]})]})]}),a.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0 border-r border-gray-200 bg-white",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center flex-shrink-0 px-4",children:[a.jsx(x.Z,{className:"h-8 w-8 text-primary-600"}),a.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"LocalMailer"})]}),a.jsx("nav",{className:"mt-5 flex-1 px-2 space-y-1",children:N.map(e=>{let s=e.icon,r=t.pathname===e.href;return(0,a.jsxs)(n(),{href:e.href,className:`${r?"sidebar-link active":"sidebar-link"}`,children:[a.jsx(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]}),a.jsx("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[a.jsx("div",{children:a.jsx("img",{className:"inline-block h-9 w-9 rounded-full",src:s?.user?.image||"/api/placeholder/36/36",alt:""})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700",children:s?.user?.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[s?.user?.plan||"Free"," Plan"]})]})]})})]})}),(0,a.jsxs)("div",{className:"lg:pl-64 flex flex-col flex-1",children:[a.jsx("div",{className:"sticky top-0 z-10 lg:hidden pl-1 pt-1 sm:pl-3 sm:pt-3 bg-gray-50",children:a.jsx("button",{className:"-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-gray-500 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500",onClick:()=>v(!0),children:a.jsx(y.Z,{className:"h-6 w-6"})})}),a.jsx("main",{className:"flex-1",children:a.jsx("div",{className:"py-6",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e})})})]})]})}},243:(e,s,t)=>{"use strict";t.d(s,{L:()=>c});let a=require("next-auth/providers/google");var r=t.n(a);let l=require("@next-auth/prisma-adapter"),i=require("@prisma/client"),n=globalThis.prisma??new i.PrismaClient({log:["error"]}),c={adapter:(0,l.PrismaAdapter)(n),providers:[r()({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})],callbacks:{async session({session:e,user:s}){if(e?.user&&s){e.user.id=s.id;let t=await n.subscription.findUnique({where:{userId:s.id}});e.user.plan=t?.plan||"free",e.user.subscriptionStatus=t?.status||"inactive"}return e},async signIn({user:e,account:s,profile:t}){if(e.email&&s?.provider==="google")try{await n.emailSettings.upsert({where:{userId:e.id},create:{userId:e.id,fromName:e.name||"Your Business",fromEmail:e.email,replyTo:e.email},update:{}})}catch(e){console.error("Error creating email settings:",e)}return!0}},session:{strategy:"database"},pages:{signIn:"/auth/signin",error:"/auth/error"}}},1940:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>o});var r=t(997);t(6764);var l=t(1649),i=t(9752),n=t(6689),c=t(6201),d=e([i,c]);function o({Component:e,pageProps:{session:s,...t}}){let[a]=(0,n.useState)(()=>new i.QueryClient);return r.jsx(l.SessionProvider,{session:s,children:(0,r.jsxs)(i.QueryClientProvider,{client:a,children:[r.jsx(e,{...t}),r.jsx(c.Toaster,{position:"top-right"})]})})}[i,c]=d.then?(await d)():d,a()}catch(e){a(e)}})},9537:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j,getServerSideProps:()=>y});var a=t(997),r=t(3227),l=t(243),i=t(3042),n=t(6689),c=t(1590),d=t(597),o=t(8387);let m=(0,o.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var x=t(9735);let h=(0,o.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var u=t(1664),p=t.n(u),f=t(1163);function g(){let[e,s]=(0,n.useState)(null),[t,r]=(0,n.useState)(!1),[l,i]=(0,n.useState)([]),[o,u]=(0,n.useState)([]),[g,j]=(0,n.useState)(null);(0,f.useRouter)();let y=(0,n.useCallback)(e=>{let t=e.target.files?.[0];if(t){if("text/csv"!==t.type&&!t.name.endsWith(".csv")){u(["Please upload a CSV file"]);return}s(t),u([]),v(t)}},[]),v=e=>{let s=new FileReader;s.onload=e=>{let s=e.target?.result.split("\n").filter(e=>e.trim());if(s.length<2){u(["CSV file must contain at least a header row and one data row"]);return}let t=s[0].split(",").map(e=>e.trim().toLowerCase()),a=t.findIndex(e=>e.includes("email"));if(-1===a){u(["CSV file must contain an email column"]);return}let r=t.findIndex(e=>e.includes("first")&&e.includes("name")),l=t.findIndex(e=>e.includes("last")&&e.includes("name")),n=t.findIndex(e=>e.includes("phone")),c=t.findIndex(e=>e.includes("tag")),d=[],o=[];s.slice(1).forEach((e,s)=>{let t=e.split(",").map(e=>e.trim().replace(/"/g,"")),i=t[a]?.toLowerCase();if(!i||!i.includes("@")){o.push(`Row ${s+2}: Invalid email address`);return}let m={email:i,firstName:r>=0?t[r]:void 0,lastName:l>=0?t[l]:void 0,phone:n>=0?t[n]:void 0,tags:c>=0&&t[c]?t[c].split(";").map(e=>e.trim()).filter(e=>e):void 0};d.push(m)}),i(d.slice(0,10)),u(o.slice(0,5))},s.readAsText(e)},N=async()=>{if(e&&0!==l.length){r(!0);try{let s=new FormData;s.append("file",e);let t=await fetch("/api/contacts/import",{method:"POST",body:s});if(t.ok){let e=await t.json();j(e)}else{let e=await t.json();u([e.error||"Import failed"])}}catch(e){u(["Import failed. Please try again."])}finally{r(!1)}}};return g?(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[a.jsx("div",{className:"mb-6",children:(0,a.jsxs)(p(),{href:"/dashboard/contacts",className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[a.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Back to Contacts"]})}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(d.Z,{className:"mx-auto h-16 w-16 text-green-500"}),a.jsx("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Import Complete"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Your contacts have been imported successfully."})]}),(0,a.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-5 sm:grid-cols-3",children:[(0,a.jsxs)("div",{className:"stats-card text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:g.successful}),a.jsx("div",{className:"text-sm text-gray-500",children:"Successfully Imported"})]}),(0,a.jsxs)("div",{className:"stats-card text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:g.duplicates}),a.jsx("div",{className:"text-sm text-gray-500",children:"Duplicates Skipped"})]}),(0,a.jsxs)("div",{className:"stats-card text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.failed}),a.jsx("div",{className:"text-sm text-gray-500",children:"Failed to Import"})]})]}),(0,a.jsxs)("div",{className:"mt-8 flex justify-center space-x-4",children:[a.jsx(p(),{href:"/dashboard/contacts",className:"btn-primary",children:"View Contacts"}),a.jsx("button",{onClick:()=>{j(null),s(null),i([]),u([])},className:"btn-outline",children:"Import More"})]})]})]}):(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[a.jsx("div",{className:"mb-6",children:(0,a.jsxs)(p(),{href:"/dashboard/contacts",className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[a.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Back to Contacts"]})}),a.jsx("div",{className:"md:flex md:items-center md:justify-between mb-8",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Import Contacts"}),a.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Upload a CSV file to bulk import your contacts."})]})}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8",children:[a.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-4",children:"Import Your Audience"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-blue-800",children:[(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"CSV file required:"})," Must include an email column"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"Optional fields:"})," first_name, last_name, phone, tags, source"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"Creator-friendly:"})," Works with Substack, Mailchimp, ConvertKit exports"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"No limits:"})," Import unlimited contacts on any plan"]}),(0,a.jsxs)("p",{children:["• ",a.jsx("strong",{children:"Clean data:"})," We'll automatically remove duplicates and invalid emails"]})]}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob(["email,first_name,last_name,phone,tags\nexample@business.com,John,Doe,555-1234,customer;vip"],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="contact_import_template.csv",t.click(),window.URL.revokeObjectURL(s)},className:"mt-4 inline-flex items-center text-sm font-medium text-blue-600 hover:text-blue-500",children:[a.jsx(m,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),a.jsx("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[a.jsx("div",{className:"max-w-lg mx-auto",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(x.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,a.jsxs)("span",{className:"mt-2 block text-sm font-medium text-gray-900",children:["Drop your CSV file here, or"," ",a.jsx("span",{className:"text-blue-600 hover:text-blue-500",children:"browse"})]}),a.jsx("input",{id:"file-upload",name:"file-upload",type:"file",accept:".csv",className:"sr-only",onChange:y})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"CSV files up to 10MB"})]})]})}),o.length>0&&a.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx(h,{className:"h-5 w-5 text-red-400"}),(0,a.jsxs)("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Import Errors"}),a.jsx("div",{className:"mt-2 text-sm text-red-700",children:a.jsx("ul",{className:"list-disc list-inside space-y-1",children:o.map((e,s)=>a.jsx("li",{children:e},s))})})]})]})}),l.length>0&&(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Preview"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Showing first 10 of ",l.length," contacts"]})]}),a.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((e,s)=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.email}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.phone||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.tags?.join(", ")||"-"})]},s))})]})}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx("button",{onClick:N,disabled:t||o.length>0,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:t?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Importing..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"Import Contacts"]})})})]})]})})]})}function j(){return a.jsx(i.Z,{children:a.jsx(g,{})})}let y=async e=>await (0,r.getServerSession)(e.req,e.res,l.L)?{props:{}}:{redirect:{destination:"/auth/signin",permanent:!1}}},6764:()=>{},3227:e=>{"use strict";e.exports=require("next-auth")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},9752:e=>{"use strict";e.exports=import("@tanstack/react-query")},6201:e=>{"use strict";e.exports=import("react-hot-toast")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")},1590:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},597:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]])},9735:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[388,571,119],()=>t(4045));module.exports=a})();