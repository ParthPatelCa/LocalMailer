(()=>{var e={};e.id=621,e.ids=[621,888,660],e.modules={7343:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>g,default:()=>o,getServerSideProps:()=>p,getStaticPaths:()=>u,getStaticProps:()=>h,reportWebVitals:()=>f,routeModule:()=>w,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>N,unstable_getStaticProps:()=>j});var r=t(7093),l=t(5244),i=t(1323),c=t(5388),n=t.n(c),d=t(1940),x=t(9543),m=e([d]);d=(m.then?(await m)():m)[0];let o=(0,i.l)(x,"default"),h=(0,i.l)(x,"getStaticProps"),u=(0,i.l)(x,"getStaticPaths"),p=(0,i.l)(x,"getServerSideProps"),g=(0,i.l)(x,"config"),f=(0,i.l)(x,"reportWebVitals"),j=(0,i.l)(x,"unstable_getStaticProps"),N=(0,i.l)(x,"unstable_getStaticPaths"),y=(0,i.l)(x,"unstable_getStaticParams"),v=(0,i.l)(x,"unstable_getServerProps"),b=(0,i.l)(x,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/dashboard/contacts",pathname:"/dashboard/contacts",bundlePath:"",filename:""},components:{App:d.default,Document:n()},userland:x});a()}catch(e){a(e)}})},3042:(e,s,t)=>{"use strict";t.d(s,{Z:()=>y});var a=t(997),r=t(6689),l=t(1649),i=t(1664),c=t.n(i),n=t(1163),d=t(5491),x=t(8936),m=t(802),o=t(6271),h=t(467),u=t(9832),p=t(7344),g=t(2656),f=t(9067),j=t(1203),N=t(1924);function y({children:e}){let{data:s}=(0,l.useSession)(),t=(0,n.useRouter)(),[i,y]=(0,r.useState)(!1),v=[{name:"Overview",href:"/dashboard",icon:d.Z},{name:"Contacts",href:"/dashboard/contacts",icon:x.Z},{name:"Campaigns",href:"/dashboard/campaigns",icon:m.Z},{name:"Templates",href:"/dashboard/templates",icon:o.Z},{name:"Analytics",href:"/dashboard/analytics",icon:h.Z},{name:"Settings",href:"/dashboard/settings",icon:u.Z}];return p.Z,g.Z,f.Z,(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:`${i?"block":"hidden"} fixed inset-0 flex z-40 lg:hidden`,children:[a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>y(!1)}),(0,a.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[a.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:a.jsx("button",{className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>y(!1),children:a.jsx(j.Z,{className:"h-6 w-6 text-white"})})}),(0,a.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 flex items-center px-4",children:[a.jsx(o.Z,{className:"h-8 w-8 text-primary-600"}),a.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"LocalMailer"})]}),a.jsx("nav",{className:"mt-5 px-2 space-y-1",children:v.map(e=>{let s=e.icon,r=t.pathname===e.href;return(0,a.jsxs)(c(),{href:e.href,className:`${r?"sidebar-link active":"sidebar-link"}`,children:[a.jsx(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]})]})]}),a.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0 border-r border-gray-200 bg-white",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center flex-shrink-0 px-4",children:[a.jsx(o.Z,{className:"h-8 w-8 text-primary-600"}),a.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"LocalMailer"})]}),a.jsx("nav",{className:"mt-5 flex-1 px-2 space-y-1",children:v.map(e=>{let s=e.icon,r=t.pathname===e.href;return(0,a.jsxs)(c(),{href:e.href,className:`${r?"sidebar-link active":"sidebar-link"}`,children:[a.jsx(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]}),a.jsx("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[a.jsx("div",{children:a.jsx("img",{className:"inline-block h-9 w-9 rounded-full",src:s?.user?.image||"/api/placeholder/36/36",alt:""})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700",children:s?.user?.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[s?.user?.plan||"Free"," Plan"]})]})]})})]})}),(0,a.jsxs)("div",{className:"lg:pl-64 flex flex-col flex-1",children:[a.jsx("div",{className:"sticky top-0 z-10 lg:hidden pl-1 pt-1 sm:pl-3 sm:pt-3 bg-gray-50",children:a.jsx("button",{className:"-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-gray-500 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500",onClick:()=>y(!0),children:a.jsx(N.Z,{className:"h-6 w-6"})})}),a.jsx("main",{className:"flex-1",children:a.jsx("div",{className:"py-6",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e})})})]})]})}},243:(e,s,t)=>{"use strict";t.d(s,{L:()=>n});let a=require("next-auth/providers/google");var r=t.n(a);let l=require("@next-auth/prisma-adapter"),i=require("@prisma/client"),c=globalThis.prisma??new i.PrismaClient({log:["error"]}),n={adapter:(0,l.PrismaAdapter)(c),providers:[r()({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})],callbacks:{async session({session:e,user:s}){if(e?.user&&s){e.user.id=s.id;let t=await c.subscription.findUnique({where:{userId:s.id}});e.user.plan=t?.plan||"free",e.user.subscriptionStatus=t?.status||"inactive"}return e},async signIn({user:e,account:s,profile:t}){if(e.email&&s?.provider==="google")try{await c.emailSettings.upsert({where:{userId:e.id},create:{userId:e.id,fromName:e.name||"Your Business",fromEmail:e.email,replyTo:e.email},update:{}})}catch(e){console.error("Error creating email settings:",e)}return!0}},session:{strategy:"database"},pages:{signIn:"/auth/signin",error:"/auth/error"}}},1940:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>x});var r=t(997);t(6764);var l=t(1649),i=t(9752),c=t(6689),n=t(6201),d=e([i,n]);function x({Component:e,pageProps:{session:s,...t}}){let[a]=(0,c.useState)(()=>new i.QueryClient);return r.jsx(l.SessionProvider,{session:s,children:(0,r.jsxs)(i.QueryClientProvider,{client:a,children:[r.jsx(e,{...t}),r.jsx(n.Toaster,{position:"top-right"})]})})}[i,n]=d.then?(await d)():d,a()}catch(e){a(e)}})},9543:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N,getServerSideProps:()=>y});var a=t(997),r=t(3227),l=t(243),i=t(3042),c=t(6689),n=t(9735),d=t(8347),x=t(8387);let m=(0,x.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),o=(0,x.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var h=t(6271);let u=(0,x.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var p=t(7150),g=t(1664),f=t.n(g);function j(){let[e,s]=(0,c.useState)([]),[t,r]=(0,c.useState)(!0),[l,i]=(0,c.useState)(""),[x,g]=(0,c.useState)("all");(0,c.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=await fetch("/api/contacts");if(e.ok){let t=await e.json();s(t)}}catch(e){console.error("Error fetching contacts:",e)}finally{r(!1)}},N=e.filter(e=>{let s=""===l||e.email.toLowerCase().includes(l.toLowerCase())||e.firstName?.toLowerCase().includes(l.toLowerCase())||e.lastName?.toLowerCase().includes(l.toLowerCase()),t="all"===x||e.status===x;return s&&t});return t?(0,a.jsxs)("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),a.jsx("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-4"}),a.jsx("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>a.jsx("div",{className:"h-12 bg-gray-200 rounded"},s))})]})})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"md:flex md:items-center md:justify-between mb-8",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Contacts"}),a.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage your email subscribers and audience segments."})]}),(0,a.jsxs)("div",{className:"mt-4 flex space-x-3 md:mt-0 md:ml-4",children:[(0,a.jsxs)(f(),{href:"/dashboard/contacts/import",className:"btn-outline inline-flex items-center",children:[a.jsx(n.Z,{className:"h-4 w-4 mr-2"}),"Import"]}),(0,a.jsxs)(f(),{href:"/dashboard/contacts/new",className:"btn-primary inline-flex items-center",children:[a.jsx(d.Z,{className:"h-4 w-4 mr-2"}),"Add Contact"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-3 lg:grid-cols-4 mb-8",children:[a.jsx("div",{className:"stats-card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"})})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Subscribed"}),a.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:e.filter(e=>"subscribed"===e.status).length})]})})]})}),a.jsx("div",{className:"stats-card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"})})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Unsubscribed"}),a.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:e.filter(e=>"unsubscribed"===e.status).length})]})})]})}),a.jsx("div",{className:"stats-card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"})})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Bounced"}),a.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:e.filter(e=>"bounced"===e.status).length})]})})]})}),a.jsx("div",{className:"stats-card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"})})}),a.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[a.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total"}),a.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:e.length})]})})]})})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("div",{className:"max-w-lg w-full lg:max-w-xs",children:(0,a.jsxs)("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(m,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"search",className:"input-field pl-10",placeholder:"Search contacts...",value:l,onChange:e=>i(e.target.value)})]})})}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("select",{className:"input-field w-auto",value:x,onChange:e=>g(e.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"subscribed",children:"Subscribed"}),a.jsx("option",{value:"unsubscribed",children:"Unsubscribed"}),a.jsx("option",{value:"bounced",children:"Bounced"})]}),(0,a.jsxs)("button",{className:"btn-outline",children:[a.jsx(o,{className:"h-4 w-4 mr-2"}),"More Filters"]})]})]})}),0===N.length&&!t&&(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx(h.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No contacts"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:0===e.length?"Get started by importing your contacts or adding them manually.":"No contacts match your search criteria."}),0===e.length&&a.jsx("div",{className:"mt-6",children:(0,a.jsxs)(f(),{href:"/dashboard/contacts/import",className:"btn-primary inline-flex items-center",children:[a.jsx(n.Z,{className:"h-4 w-4 mr-2"}),"Import Contacts"]})})]}),N.length>0&&a.jsx("div",{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Added"}),a.jsx("th",{className:"relative px-6 py-3",children:a.jsx("span",{className:"sr-only",children:"Actions"})})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:a.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:a.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.firstName?.[0]||e.email[0].toUpperCase()})})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:e.email}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(h.Z,{className:"h-3 w-3 mr-1"}),e.email]}),e.phone&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(u,{className:"h-3 w-3 mr-1"}),e.phone]})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"subscribed"===e.status?"bg-green-100 text-green-800":"unsubscribed"===e.status?"bg-red-100 text-red-800":"bounced"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:e.status})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,2).map((e,s)=>a.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded",children:e},s)),e.tags.length>2&&(0,a.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-gray-100 text-gray-500 rounded",children:["+",e.tags.length-2]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.source}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsx("button",{className:"text-gray-400 hover:text-gray-500",children:a.jsx(p.Z,{className:"h-5 w-5"})})})]},e.id))})]})})]})]})}function N(){return a.jsx(i.Z,{children:a.jsx(j,{})})}let y=async e=>await (0,r.getServerSession)(e.req,e.res,l.L)?{props:{}}:{redirect:{destination:"/auth/signin",permanent:!1}}},6764:()=>{},3227:e=>{"use strict";e.exports=require("next-auth")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},9752:e=>{"use strict";e.exports=import("@tanstack/react-query")},6201:e=>{"use strict";e.exports=import("react-hot-toast")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")},7150:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},8347:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9735:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8387).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[388,571,119],()=>t(7343));module.exports=a})();